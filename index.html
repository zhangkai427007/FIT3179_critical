<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Greater Kuala Lumpur Transport Visualisations</title>

  <!-- Vega / Vega-Lite / TopoJSON / Vega-Embed -->
  <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>

  <style>
    body { font-family: Arial, sans-serif; margin: 28px; background:#fafafa; color:#111; }
    h1 { text-align:center; margin-bottom:6px; }
    .section-title { text-align:center; margin-top:28px; margin-bottom:6px; font-size:18px; }
    .vis { display:flex; justify-content:center; margin: 10px 0 30px; }
    .annotation { max-width:900px; margin: 0 auto 20px; font-size:14px; color:#333; line-height:1.5; }
  </style>
</head>
<body>

<h1>Greater Kuala Lumpur — Urban Rail Analysis</h1>

<div class="section-title">1. Urban Rail Network Map</div>
<div class="annotation">
  The rail network in Kuala Lumpur is densest within the city, especially around central KL and Petaling. Interestingly, areas like Petaling have a dense network even though their population is not the highest, suggesting uneven urban development and suboptimal transport planning in the metropolitan region.
</div>
<div class="vis" id="map_vis">Loading map…</div>

<div class="section-title">2. Daily Rail Ridership by Line</div>
<div class="annotation">
  Ridership across all lines is relatively stable. The LRT Kelana Jaya line has the highest daily ridership, which aligns with the map showing it passes through central KL, an important urban corridor.
</div>
<div class="vis" id="ridership_vis">Loading ridership chart…</div>

<div class="section-title">3. Vehicle Ownership per Region</div>
<div class="annotation">
  Monthly vehicle counts indicate trends in urban mobility. The data shows the level of vehicle ownership across key areas in Greater Kuala Lumpur, highlighting the reliance on private transport.
</div>
<div class="vis" id="vehicle_vis">Loading vehicle chart…</div>

<script>
(async function(){

  // 1️⃣ Urban Map
  vegaEmbed('#map_vis', 'https://raw.githubusercontent.com/zhangkai427007/FIT3179_critical/main/urban-map-json', {renderer:'svg', actions:true})
    .then(() => console.log('Map embedded successfully'))
    .catch(err => {console.error(err); document.getElementById('map_vis').textContent='Failed to load map';});

  // 2️⃣ Ridership Line Chart
  vegaEmbed('#ridership_vis', {
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "width": 700, "height": 400,
    "data": {
      "url": "https://raw.githubusercontent.com/zhangkai427007/fit3179_week10/main/ridership.json"
    },
    "mark": {"type":"line", "point":true},
    "encoding": {
      "x": {"field":"month", "type":"temporal", "title":"Month"},
      "y": {"field":"ridership", "type":"quantitative", "title":"Daily Ridership"},
      "color": {"field":"line", "type":"nominal", "title":"Line"},
      "tooltip": [
        {"field":"line","type":"nominal","title":"Line"},
        {"field":"month","type":"temporal","title":"Month"},
        {"field":"ridership","type":"quantitative","title":"Ridership"}
      ]
    }
  }).then(() => console.log('Ridership chart embedded'))
    .catch(err => {console.error(err); document.getElementById('ridership_vis').textContent='Failed to load ridership';});

  // 3️⃣ Vehicle Ownership Line Chart
  vegaEmbed('#vehicle_vis', {
    "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
    "width": 700, "height": 400,
    "data": {
      "url": "https://raw.githubusercontent.com/zhangkai427007/FIT3179_critical/main/vehicle.json"
    },
    "mark": {"type":"line", "point":true},
    "encoding": {
      "x": {"field":"month", "type":"temporal", "title":"Month"},
      "y": {"field":"vehicle_count", "type":"quantitative", "title":"Number of Vehicles"},
      "color": {"field":"state", "type":"nominal", "title":"Region"},
      "tooltip": [
        {"field":"state","type":"nominal","title":"Region"},
        {"field":"month","type":"temporal","title":"Month"},
        {"field":"vehicle_count","type":"quantitative","title":"Vehicle Count"}
      ]
    }
  }).then(() => console.log('Vehicle chart embedded'))
    .catch(err => {console.error(err); document.getElementById('vehicle_vis').textContent='Failed to load vehicle chart';});

})();
</script>

</body>
</html>

